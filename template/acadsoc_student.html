<!DOCTYPE html>
<html lang="en" style="height:100%">
<head>
    <meta charset="UTF-8">
    <title>getmessage</title>
</head>
<body style="height:100%;margin:0;padding:0">
    <script>
        //iframe接收消息，并把当前颜色发送给主页面
        window.onload = () => {
            let btn = document.querySelector('#btn')
            // const start = (cname) => {
            btn.onclick = () => {
                let iframe = document.createElement('iframe')
                iframe.setAttribute('allow', 'camera;microphone')
                iframe.setAttribute('style', 'width:100%;height:100%;border:0;')
                iframe.setAttribute('frameBorder', '0')
                iframe.setAttribute('src', './classroom.html')
                // iframe.setAttribute('src', 'https://solutions-apaas.agora.io/acadsoc/1.1.2.10/app/classroom.html')
                let body = document.getElementsByTagName('body')[0]

                // let iframe = document.querySelector('#agoraproxy')
                let roomUuid = document.querySelector('#roomUuid').value
                // let roomUuid = cname

                body.appendChild(iframe)

                iframe.onload = () => {
                    const courseWareList2 = JSON.parse('[{"resourceName":"Static_Chatting with Neighbors_1","resourceUuid":"88496326_116491","ext":"pdf","url":"","conversion":{"type":"static"},"size":12,"updateTime":0,"scenes":[{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/49fab3f0f8b411eaa735b104252faf02/1.jpg","width":1600,"height":900},"name":"Scene 1"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/49fab3f0f8b411eaa735b104252faf02/2.jpg","width":1600,"height":900},"name":"Scene 2"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/49fab3f0f8b411eaa735b104252faf02/3.jpg","width":1600,"height":900},"name":"Scene 3"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/49fab3f0f8b411eaa735b104252faf02/4.jpg","width":1600,"height":900},"name":"Scene 4"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/49fab3f0f8b411eaa735b104252faf02/5.jpg","width":1600,"height":900},"name":"Scene 5"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/49fab3f0f8b411eaa735b104252faf02/6.jpg","width":1600,"height":900},"name":"Scene 6"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/49fab3f0f8b411eaa735b104252faf02/7.jpg","width":1600,"height":900},"name":"Scene 7"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/49fab3f0f8b411eaa735b104252faf02/8.jpg","width":1600,"height":900},"name":"Scene 8"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/49fab3f0f8b411eaa735b104252faf02/9.jpg","width":1600,"height":900},"name":"Scene 9"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/49fab3f0f8b411eaa735b104252faf02/10.jpg","width":1600,"height":900},"name":"Scene 10"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/49fab3f0f8b411eaa735b104252faf02/11.jpg","width":1600,"height":900},"name":"Scene 11"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/49fab3f0f8b411eaa735b104252faf02/12.jpg","width":1600,"height":900},"name":"Scene 12"}],"convert":true,"taskUuid":"49fab3f0f8b411eaa735b104252faf02","taskToken":null,"taskProgress":{"totalPageSize":12,"convertedPageSize":12,"convertedPercentage":100,"convertedFileList":[{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/49fab3f0f8b411eaa735b104252faf02/1.jpg","width":1600,"height":900},"name":"Scene 1"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/49fab3f0f8b411eaa735b104252faf02/2.jpg","width":1600,"height":900},"name":"Scene 2"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/49fab3f0f8b411eaa735b104252faf02/3.jpg","width":1600,"height":900},"name":"Scene 3"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/49fab3f0f8b411eaa735b104252faf02/4.jpg","width":1600,"height":900},"name":"Scene 4"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/49fab3f0f8b411eaa735b104252faf02/5.jpg","width":1600,"height":900},"name":"Scene 5"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/49fab3f0f8b411eaa735b104252faf02/6.jpg","width":1600,"height":900},"name":"Scene 6"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/49fab3f0f8b411eaa735b104252faf02/7.jpg","width":1600,"height":900},"name":"Scene 7"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/49fab3f0f8b411eaa735b104252faf02/8.jpg","width":1600,"height":900},"name":"Scene 8"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/49fab3f0f8b411eaa735b104252faf02/9.jpg","width":1600,"height":900},"name":"Scene 9"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/49fab3f0f8b411eaa735b104252faf02/10.jpg","width":1600,"height":900},"name":"Scene 10"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/49fab3f0f8b411eaa735b104252faf02/11.jpg","width":1600,"height":900},"name":"Scene 11"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/49fab3f0f8b411eaa735b104252faf02/12.jpg","width":1600,"height":900},"name":"Scene 12"}]}},{"resourceName":"Static_Chatting with Neighbors_2","resourceUuid":"88496326_116491","ext":"pdf","url":"","conversion":{"type":"static"},"size":12,"updateTime":0,"scenes":[{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/6243f010f8b511eaa735b104252faf02/1.jpg","width":1600,"height":900},"name":"Scene 1"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/6243f010f8b511eaa735b104252faf02/2.jpg","width":1600,"height":900},"name":"Scene 2"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/6243f010f8b511eaa735b104252faf02/3.jpg","width":1600,"height":900},"name":"Scene 3"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/6243f010f8b511eaa735b104252faf02/4.jpg","width":1600,"height":900},"name":"Scene 4"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/6243f010f8b511eaa735b104252faf02/5.jpg","width":1600,"height":900},"name":"Scene 5"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/6243f010f8b511eaa735b104252faf02/6.jpg","width":1600,"height":900},"name":"Scene 6"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/6243f010f8b511eaa735b104252faf02/7.jpg","width":1600,"height":900},"name":"Scene 7"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/6243f010f8b511eaa735b104252faf02/8.jpg","width":1600,"height":900},"name":"Scene 8"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/6243f010f8b511eaa735b104252faf02/9.jpg","width":1600,"height":900},"name":"Scene 9"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/6243f010f8b511eaa735b104252faf02/10.jpg","width":1600,"height":900},"name":"Scene 10"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/6243f010f8b511eaa735b104252faf02/11.jpg","width":1600,"height":900},"name":"Scene 11"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/6243f010f8b511eaa735b104252faf02/12.jpg","width":1600,"height":900},"name":"Scene 12"}],"convert":true,"taskUuid":"6243f010f8b511eaa735b104252faf02","taskToken":null,"taskProgress":{"totalPageSize":12,"convertedPageSize":12,"convertedPercentage":100,"convertedFileList":[{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/6243f010f8b511eaa735b104252faf02/1.jpg","width":1600,"height":900},"name":"Scene 1"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/6243f010f8b511eaa735b104252faf02/2.jpg","width":1600,"height":900},"name":"Scene 2"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/6243f010f8b511eaa735b104252faf02/3.jpg","width":1600,"height":900},"name":"Scene 3"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/6243f010f8b511eaa735b104252faf02/4.jpg","width":1600,"height":900},"name":"Scene 4"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/6243f010f8b511eaa735b104252faf02/5.jpg","width":1600,"height":900},"name":"Scene 5"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/6243f010f8b511eaa735b104252faf02/6.jpg","width":1600,"height":900},"name":"Scene 6"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/6243f010f8b511eaa735b104252faf02/7.jpg","width":1600,"height":900},"name":"Scene 7"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/6243f010f8b511eaa735b104252faf02/8.jpg","width":1600,"height":900},"name":"Scene 8"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/6243f010f8b511eaa735b104252faf02/9.jpg","width":1600,"height":900},"name":"Scene 9"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/6243f010f8b511eaa735b104252faf02/10.jpg","width":1600,"height":900},"name":"Scene 10"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/6243f010f8b511eaa735b104252faf02/11.jpg","width":1600,"height":900},"name":"Scene 11"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/6243f010f8b511eaa735b104252faf02/12.jpg","width":1600,"height":900},"name":"Scene 12"}]}},{"resourceName":"Static_Chatting with Neighbors_3","resourceUuid":"88496326_116491","ext":"pdf","url":"","conversion":{"type":"static"},"size":12,"updateTime":0,"scenes":[{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/76843b80f00d11ea8e14f53e3889d73a/1.jpg","width":1600,"height":900},"name":"Scene 1"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/76843b80f00d11ea8e14f53e3889d73a/2.jpg","width":1600,"height":900},"name":"Scene 2"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/76843b80f00d11ea8e14f53e3889d73a/3.jpg","width":1600,"height":900},"name":"Scene 3"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/76843b80f00d11ea8e14f53e3889d73a/4.jpg","width":1600,"height":900},"name":"Scene 4"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/76843b80f00d11ea8e14f53e3889d73a/5.jpg","width":1600,"height":900},"name":"Scene 5"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/76843b80f00d11ea8e14f53e3889d73a/6.jpg","width":1600,"height":900},"name":"Scene 6"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/76843b80f00d11ea8e14f53e3889d73a/7.jpg","width":1600,"height":900},"name":"Scene 7"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/76843b80f00d11ea8e14f53e3889d73a/8.jpg","width":1600,"height":900},"name":"Scene 8"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/76843b80f00d11ea8e14f53e3889d73a/9.jpg","width":1600,"height":900},"name":"Scene 9"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/76843b80f00d11ea8e14f53e3889d73a/10.jpg","width":1600,"height":900},"name":"Scene 10"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/76843b80f00d11ea8e14f53e3889d73a/11.jpg","width":1600,"height":900},"name":"Scene 11"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/76843b80f00d11ea8e14f53e3889d73a/12.jpg","width":1600,"height":900},"name":"Scene 12"}],"convert":true,"taskUuid":"76843b80f00d11ea8e14f53e3889d73a","taskToken":null,"taskProgress":{"totalPageSize":12,"convertedPageSize":12,"convertedPercentage":100,"convertedFileList":[{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/76843b80f00d11ea8e14f53e3889d73a/1.jpg","width":1600,"height":900},"name":"Scene 1"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/76843b80f00d11ea8e14f53e3889d73a/2.jpg","width":1600,"height":900},"name":"Scene 2"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/76843b80f00d11ea8e14f53e3889d73a/3.jpg","width":1600,"height":900},"name":"Scene 3"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/76843b80f00d11ea8e14f53e3889d73a/4.jpg","width":1600,"height":900},"name":"Scene 4"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/76843b80f00d11ea8e14f53e3889d73a/5.jpg","width":1600,"height":900},"name":"Scene 5"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/76843b80f00d11ea8e14f53e3889d73a/6.jpg","width":1600,"height":900},"name":"Scene 6"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/76843b80f00d11ea8e14f53e3889d73a/7.jpg","width":1600,"height":900},"name":"Scene 7"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/76843b80f00d11ea8e14f53e3889d73a/8.jpg","width":1600,"height":900},"name":"Scene 8"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/76843b80f00d11ea8e14f53e3889d73a/9.jpg","width":1600,"height":900},"name":"Scene 9"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/76843b80f00d11ea8e14f53e3889d73a/10.jpg","width":1600,"height":900},"name":"Scene 10"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/76843b80f00d11ea8e14f53e3889d73a/11.jpg","width":1600,"height":900},"name":"Scene 11"},{"ppt":{"src":"https://agoracategroy.acadsoc.com.cn/staticConvert/76843b80f00d11ea8e14f53e3889d73a/12.jpg","width":1600,"height":900},"name":"Scene 12"}]}}]')
                    const courseWareList = JSON.parse("[{\"resourceName\":\"Dynamic_Comparing Animals (1)_1\",\"resourceUuid\":\"82320729_122565\",\"ext\":\"pptx\",\"url\":\"\",\"conversion\":{\"type\":\"dynamic\"},\"size\":14,\"updateTime\":0,\"scenes\":[{\"ppt\":{\"src\":\"pptx://convertcdn.netless.link/dynamicConvert/288e965056d811eba09c951e24c96d50/1.slide\",\"width\":1890,\"height\":1058},\"name\":\"Scene 1\"},{\"ppt\":{\"src\":\"pptx://convertcdn.netless.link/dynamicConvert/288e965056d811eba09c951e24c96d50/2.slide\",\"width\":1890,\"height\":1058},\"name\":\"Scene 2\"},{\"ppt\":{\"src\":\"pptx://convertcdn.netless.link/dynamicConvert/288e965056d811eba09c951e24c96d50/3.slide\",\"width\":1890,\"height\":1058},\"name\":\"Scene 3\"},{\"ppt\":{\"src\":\"pptx://convertcdn.netless.link/dynamicConvert/288e965056d811eba09c951e24c96d50/4.slide\",\"width\":1890,\"height\":1058},\"name\":\"Scene 4\"},{\"ppt\":{\"src\":\"pptx://convertcdn.netless.link/dynamicConvert/288e965056d811eba09c951e24c96d50/5.slide\",\"width\":1890,\"height\":1058},\"name\":\"Scene 5\"},{\"ppt\":{\"src\":\"pptx://convertcdn.netless.link/dynamicConvert/288e965056d811eba09c951e24c96d50/6.slide\",\"width\":1890,\"height\":1058},\"name\":\"Scene 6\"},{\"ppt\":{\"src\":\"pptx://convertcdn.netless.link/dynamicConvert/288e965056d811eba09c951e24c96d50/7.slide\",\"width\":1890,\"height\":1058},\"name\":\"Scene 7\"},{\"ppt\":{\"src\":\"pptx://convertcdn.netless.link/dynamicConvert/288e965056d811eba09c951e24c96d50/8.slide\",\"width\":1890,\"height\":1058},\"name\":\"Scene 8\"},{\"ppt\":{\"src\":\"pptx://convertcdn.netless.link/dynamicConvert/288e965056d811eba09c951e24c96d50/9.slide\",\"width\":1890,\"height\":1058},\"name\":\"Scene 9\"},{\"ppt\":{\"src\":\"pptx://convertcdn.netless.link/dynamicConvert/288e965056d811eba09c951e24c96d50/10.slide\",\"width\":1890,\"height\":1058},\"name\":\"Scene 10\"},{\"ppt\":{\"src\":\"pptx://convertcdn.netless.link/dynamicConvert/288e965056d811eba09c951e24c96d50/11.slide\",\"width\":1890,\"height\":1058},\"name\":\"Scene 11\"},{\"ppt\":{\"src\":\"pptx://convertcdn.netless.link/dynamicConvert/288e965056d811eba09c951e24c96d50/12.slide\",\"width\":1890,\"height\":1058},\"name\":\"Scene 12\"},{\"ppt\":{\"src\":\"pptx://convertcdn.netless.link/dynamicConvert/288e965056d811eba09c951e24c96d50/13.slide\",\"width\":1890,\"height\":1058},\"name\":\"Scene 13\"},{\"ppt\":{\"src\":\"pptx://convertcdn.netless.link/dynamicConvert/288e965056d811eba09c951e24c96d50/14.slide\",\"width\":1890,\"height\":1058},\"name\":\"Scene 14\"}],\"convert\":true,\"taskUuid\":\"288e965056d811eba09c951e24c96d50\",\"taskToken\":null,\"taskProgress\":{\"totalPageSize\":14,\"convertedPageSize\":14,\"convertedPercentage\":100,\"convertedFileList\":[{\"ppt\":{\"src\":\"pptx://convertcdn.netless.link/dynamicConvert/288e965056d811eba09c951e24c96d50/1.slide\",\"width\":1890,\"height\":1058},\"name\":\"Scene 1\"},{\"ppt\":{\"src\":\"pptx://convertcdn.netless.link/dynamicConvert/288e965056d811eba09c951e24c96d50/2.slide\",\"width\":1890,\"height\":1058},\"name\":\"Scene 2\"},{\"ppt\":{\"src\":\"pptx://convertcdn.netless.link/dynamicConvert/288e965056d811eba09c951e24c96d50/3.slide\",\"width\":1890,\"height\":1058},\"name\":\"Scene 3\"},{\"ppt\":{\"src\":\"pptx://convertcdn.netless.link/dynamicConvert/288e965056d811eba09c951e24c96d50/4.slide\",\"width\":1890,\"height\":1058},\"name\":\"Scene 4\"},{\"ppt\":{\"src\":\"pptx://convertcdn.netless.link/dynamicConvert/288e965056d811eba09c951e24c96d50/5.slide\",\"width\":1890,\"height\":1058},\"name\":\"Scene 5\"},{\"ppt\":{\"src\":\"pptx://convertcdn.netless.link/dynamicConvert/288e965056d811eba09c951e24c96d50/6.slide\",\"width\":1890,\"height\":1058},\"name\":\"Scene 6\"},{\"ppt\":{\"src\":\"pptx://convertcdn.netless.link/dynamicConvert/288e965056d811eba09c951e24c96d50/7.slide\",\"width\":1890,\"height\":1058},\"name\":\"Scene 7\"},{\"ppt\":{\"src\":\"pptx://convertcdn.netless.link/dynamicConvert/288e965056d811eba09c951e24c96d50/8.slide\",\"width\":1890,\"height\":1058},\"name\":\"Scene 8\"},{\"ppt\":{\"src\":\"pptx://convertcdn.netless.link/dynamicConvert/288e965056d811eba09c951e24c96d50/9.slide\",\"width\":1890,\"height\":1058},\"name\":\"Scene 9\"},{\"ppt\":{\"src\":\"pptx://convertcdn.netless.link/dynamicConvert/288e965056d811eba09c951e24c96d50/10.slide\",\"width\":1890,\"height\":1058},\"name\":\"Scene 10\"},{\"ppt\":{\"src\":\"pptx://convertcdn.netless.link/dynamicConvert/288e965056d811eba09c951e24c96d50/11.slide\",\"width\":1890,\"height\":1058},\"name\":\"Scene 11\"},{\"ppt\":{\"src\":\"pptx://convertcdn.netless.link/dynamicConvert/288e965056d811eba09c951e24c96d50/12.slide\",\"width\":1890,\"height\":1058},\"name\":\"Scene 12\"},{\"ppt\":{\"src\":\"pptx://convertcdn.netless.link/dynamicConvert/288e965056d811eba09c951e24c96d50/13.slide\",\"width\":1890,\"height\":1058},\"name\":\"Scene 13\"},{\"ppt\":{\"src\":\"pptx://convertcdn.netless.link/dynamicConvert/288e965056d811eba09c951e24c96d50/14.slide\",\"width\":1890,\"height\":1058},\"name\":\"Scene 14\"}]}},{\"resourceName\":\"Static_Comparing Animals (1)_2\",\"resourceUuid\":\"82320729_122566\",\"ext\":\"pdf\",\"url\":\"\",\"conversion\":{\"type\":\"static\"},\"size\":21,\"updateTime\":0,\"scenes\":[{\"ppt\":{\"src\":\"https://agoracategroy.acadsoc.com.cn/staticConvert/0c40e220e48a11ea90665b6e81485f25/1.jpeg\",\"width\":1133,\"height\":634},\"name\":\"Scene 1\"},{\"ppt\":{\"src\":\"https://agoracategroy.acadsoc.com.cn/staticConvert/0c40e220e48a11ea90665b6e81485f25/2.jpeg\",\"width\":1133,\"height\":634},\"name\":\"Scene 2\"},{\"ppt\":{\"src\":\"https://agoracategroy.acadsoc.com.cn/staticConvert/0c40e220e48a11ea90665b6e81485f25/3.jpeg\",\"width\":1133,\"height\":634},\"name\":\"Scene 3\"},{\"ppt\":{\"src\":\"https://agoracategroy.acadsoc.com.cn/staticConvert/0c40e220e48a11ea90665b6e81485f25/4.jpeg\",\"width\":1133,\"height\":634},\"name\":\"Scene 4\"},{\"ppt\":{\"src\":\"https://agoracategroy.acadsoc.com.cn/staticConvert/0c40e220e48a11ea90665b6e81485f25/5.jpeg\",\"width\":1133,\"height\":634},\"name\":\"Scene 5\"},{\"ppt\":{\"src\":\"https://agoracategroy.acadsoc.com.cn/staticConvert/0c40e220e48a11ea90665b6e81485f25/6.jpeg\",\"width\":1133,\"height\":634},\"name\":\"Scene 6\"},{\"ppt\":{\"src\":\"https://agoracategroy.acadsoc.com.cn/staticConvert/0c40e220e48a11ea90665b6e81485f25/7.jpeg\",\"width\":1133,\"height\":634},\"name\":\"Scene 7\"},{\"ppt\":{\"src\":\"https://agoracategroy.acadsoc.com.cn/staticConvert/0c40e220e48a11ea90665b6e81485f25/8.jpeg\",\"width\":1133,\"height\":634},\"name\":\"Scene 8\"},{\"ppt\":{\"src\":\"https://agoracategroy.acadsoc.com.cn/staticConvert/0c40e220e48a11ea90665b6e81485f25/9.jpeg\",\"width\":1133,\"height\":634},\"name\":\"Scene 9\"},{\"ppt\":{\"src\":\"https://agoracategroy.acadsoc.com.cn/staticConvert/0c40e220e48a11ea90665b6e81485f25/10.jpeg\",\"width\":1133,\"height\":634},\"name\":\"Scene 10\"},{\"ppt\":{\"src\":\"https://agoracategroy.acadsoc.com.cn/staticConvert/0c40e220e48a11ea90665b6e81485f25/11.jpeg\",\"width\":1133,\"height\":634},\"name\":\"Scene 11\"},{\"ppt\":{\"src\":\"https://agoracategroy.acadsoc.com.cn/staticConvert/0c40e220e48a11ea90665b6e81485f25/12.jpeg\",\"width\":1133,\"height\":634},\"name\":\"Scene 12\"},{\"ppt\":{\"src\":\"https://agoracategroy.acadsoc.com.cn/staticConvert/0c40e220e48a11ea90665b6e81485f25/13.jpeg\",\"width\":1133,\"height\":634},\"name\":\"Scene 13\"},{\"ppt\":{\"src\":\"https://agoracategroy.acadsoc.com.cn/staticConvert/0c40e220e48a11ea90665b6e81485f25/14.jpeg\",\"width\":1133,\"height\":634},\"name\":\"Scene 14\"},{\"ppt\":{\"src\":\"https://agoracategroy.acadsoc.com.cn/staticConvert/0c40e220e48a11ea90665b6e81485f25/15.jpeg\",\"width\":1133,\"height\":634},\"name\":\"Scene 15\"},{\"ppt\":{\"src\":\"https://agoracategroy.acadsoc.com.cn/staticConvert/0c40e220e48a11ea90665b6e81485f25/16.jpeg\",\"width\":1133,\"height\":634},\"name\":\"Scene 16\"},{\"ppt\":{\"src\":\"https://agoracategroy.acadsoc.com.cn/staticConvert/0c40e220e48a11ea90665b6e81485f25/17.jpeg\",\"width\":1133,\"height\":634},\"name\":\"Scene 17\"},{\"ppt\":{\"src\":\"https://agoracategroy.acadsoc.com.cn/staticConvert/0c40e220e48a11ea90665b6e81485f25/18.jpeg\",\"width\":1133,\"height\":634},\"name\":\"Scene 18\"},{\"ppt\":{\"src\":\"https://agoracategroy.acadsoc.com.cn/staticConvert/0c40e220e48a11ea90665b6e81485f25/19.jpeg\",\"width\":1133,\"height\":634},\"name\":\"Scene 19\"},{\"ppt\":{\"src\":\"https://agoracategroy.acadsoc.com.cn/staticConvert/0c40e220e48a11ea90665b6e81485f25/20.jpeg\",\"width\":1133,\"height\":634},\"name\":\"Scene 20\"},{\"ppt\":{\"src\":\"https://agoracategroy.acadsoc.com.cn/staticConvert/0c40e220e48a11ea90665b6e81485f25/21.jpeg\",\"width\":1133,\"height\":634},\"name\":\"Scene 21\"}],\"convert\":true,\"taskUuid\":\"0c40e220e48a11ea90665b6e81485f25\",\"taskToken\":null,\"taskProgress\":{\"totalPageSize\":21,\"convertedPageSize\":21,\"convertedPercentage\":100,\"convertedFileList\":[{\"ppt\":{\"src\":\"https://agoracategroy.acadsoc.com.cn/staticConvert/0c40e220e48a11ea90665b6e81485f25/1.jpeg\",\"width\":1133,\"height\":634},\"name\":\"Scene 1\"},{\"ppt\":{\"src\":\"https://agoracategroy.acadsoc.com.cn/staticConvert/0c40e220e48a11ea90665b6e81485f25/2.jpeg\",\"width\":1133,\"height\":634},\"name\":\"Scene 2\"},{\"ppt\":{\"src\":\"https://agoracategroy.acadsoc.com.cn/staticConvert/0c40e220e48a11ea90665b6e81485f25/3.jpeg\",\"width\":1133,\"height\":634},\"name\":\"Scene 3\"},{\"ppt\":{\"src\":\"https://agoracategroy.acadsoc.com.cn/staticConvert/0c40e220e48a11ea90665b6e81485f25/4.jpeg\",\"width\":1133,\"height\":634},\"name\":\"Scene 4\"},{\"ppt\":{\"src\":\"https://agoracategroy.acadsoc.com.cn/staticConvert/0c40e220e48a11ea90665b6e81485f25/5.jpeg\",\"width\":1133,\"height\":634},\"name\":\"Scene 5\"},{\"ppt\":{\"src\":\"https://agoracategroy.acadsoc.com.cn/staticConvert/0c40e220e48a11ea90665b6e81485f25/6.jpeg\",\"width\":1133,\"height\":634},\"name\":\"Scene 6\"},{\"ppt\":{\"src\":\"https://agoracategroy.acadsoc.com.cn/staticConvert/0c40e220e48a11ea90665b6e81485f25/7.jpeg\",\"width\":1133,\"height\":634},\"name\":\"Scene 7\"},{\"ppt\":{\"src\":\"https://agoracategroy.acadsoc.com.cn/staticConvert/0c40e220e48a11ea90665b6e81485f25/8.jpeg\",\"width\":1133,\"height\":634},\"name\":\"Scene 8\"},{\"ppt\":{\"src\":\"https://agoracategroy.acadsoc.com.cn/staticConvert/0c40e220e48a11ea90665b6e81485f25/9.jpeg\",\"width\":1133,\"height\":634},\"name\":\"Scene 9\"},{\"ppt\":{\"src\":\"https://agoracategroy.acadsoc.com.cn/staticConvert/0c40e220e48a11ea90665b6e81485f25/10.jpeg\",\"width\":1133,\"height\":634},\"name\":\"Scene 10\"},{\"ppt\":{\"src\":\"https://agoracategroy.acadsoc.com.cn/staticConvert/0c40e220e48a11ea90665b6e81485f25/11.jpeg\",\"width\":1133,\"height\":634},\"name\":\"Scene 11\"},{\"ppt\":{\"src\":\"https://agoracategroy.acadsoc.com.cn/staticConvert/0c40e220e48a11ea90665b6e81485f25/12.jpeg\",\"width\":1133,\"height\":634},\"name\":\"Scene 12\"},{\"ppt\":{\"src\":\"https://agoracategroy.acadsoc.com.cn/staticConvert/0c40e220e48a11ea90665b6e81485f25/13.jpeg\",\"width\":1133,\"height\":634},\"name\":\"Scene 13\"},{\"ppt\":{\"src\":\"https://agoracategroy.acadsoc.com.cn/staticConvert/0c40e220e48a11ea90665b6e81485f25/14.jpeg\",\"width\":1133,\"height\":634},\"name\":\"Scene 14\"},{\"ppt\":{\"src\":\"https://agoracategroy.acadsoc.com.cn/staticConvert/0c40e220e48a11ea90665b6e81485f25/15.jpeg\",\"width\":1133,\"height\":634},\"name\":\"Scene 15\"},{\"ppt\":{\"src\":\"https://agoracategroy.acadsoc.com.cn/staticConvert/0c40e220e48a11ea90665b6e81485f25/16.jpeg\",\"width\":1133,\"height\":634},\"name\":\"Scene 16\"},{\"ppt\":{\"src\":\"https://agoracategroy.acadsoc.com.cn/staticConvert/0c40e220e48a11ea90665b6e81485f25/17.jpeg\",\"width\":1133,\"height\":634},\"name\":\"Scene 17\"},{\"ppt\":{\"src\":\"https://agoracategroy.acadsoc.com.cn/staticConvert/0c40e220e48a11ea90665b6e81485f25/18.jpeg\",\"width\":1133,\"height\":634},\"name\":\"Scene 18\"},{\"ppt\":{\"src\":\"https://agoracategroy.acadsoc.com.cn/staticConvert/0c40e220e48a11ea90665b6e81485f25/19.jpeg\",\"width\":1133,\"height\":634},\"name\":\"Scene 19\"},{\"ppt\":{\"src\":\"https://agoracategroy.acadsoc.com.cn/staticConvert/0c40e220e48a11ea90665b6e81485f25/20.jpeg\",\"width\":1133,\"height\":634},\"name\":\"Scene 20\"},{\"ppt\":{\"src\":\"https://agoracategroy.acadsoc.com.cn/staticConvert/0c40e220e48a11ea90665b6e81485f25/21.jpeg\",\"width\":1133,\"height\":634},\"name\":\"Scene 21\"}]}}]")
                    

                    const teachers = [
                        {userUuid: "user01", rtmToken: "006d2931ea1715c4bc9b36608770bcf6d01IAAMBKoGSLGDiJmKB4M7pkm6qxenMvL3odn6qTOnODljIwgqSoEAAAAAEACbI+ww9lQTYQEA6AP2VBNh"},
                        {userUuid: "user02", rtmToken: "006d2931ea1715c4bc9b36608770bcf6d01IAAU4zx81hnZFu/rIH92Okm7KS8SscBAGZdwRixr6BusdrJ7QxgAAAAAEACbI+wwBVUTYQEA6AMFVRNh"},
                        {userUuid: "user03", rtmToken: "006d2931ea1715c4bc9b36608770bcf6d01IAByAcSGY4DDTFqJouSO076kGJILFUn4fJDxZuwN0ODOkyRLRG8AAAAAEABqrbYC8M3iYAEA6APwzeJg"},
                        {userUuid: "user04", rtmToken: "006d2931ea1715c4bc9b36608770bcf6d01IADHWPpOxRkFpWU2djzFCnEqMykOBMYxxzKVHv1mk3TeAofeIPEAAAAAEABqrbYC983iYAEA6AP3zeJg"},
                        {userUuid: "user05", rtmToken: "006d2931ea1715c4bc9b36608770bcf6d01IABZH5K29RsV4mR0Dw1XWzSoZ0jYC8jdxAv3Ni+UwrcLBxHuJ4YAAAAAEABqrbYC/s3iYAEA6AP+zeJg"}
                    ]

                    const idx = document.querySelector('#userPicker').value

                    let teacher = teachers[idx]

                    if(!roomUuid || !teacher) {
                        alert(`info missing`)
                    } else {
                        const callback = (cachePath) => {
                        iframe.contentWindow.postMessage(JSON.stringify({
                            appId: "d2931ea1715c4bc9b36608770bcf6d01",
                            options: {
                                userUuid: teacher.userUuid,
                                rtmToken: teacher.rtmToken,
                                rtmUid: teacher.userUuid,
                                userName: "MOCK_TA",
                                roomUuid: roomUuid,
                                roomName: "test",
                                language: "en",
                                roleType: parseInt(document.querySelector('#rolePicker').value),
                                roomType:0,
                                startTime: new Date().getTime(),
                                duration: 1500,
                                translateLanguage: "auto",
                                courseWareList,
                                duration: 1500,
                                pretest: true
                            },
                            cachePath
                        }), '*')
                    }
                    window.getCachePath ? window.getCachePath(callback) : callback(undefined)
                    }

                    
                    window.addEventListener('message', function(e) {
                        let data = JSON.parse(e.data)
                        let classevent = data.classevent || {}
                        let {evt, args} = classevent
                        if(evt === 3) {
                            if(args.name === "sos") {
                                alert('sos clicked')
                            }
                        } else if(evt === 2) {
                            alert('destroyed')
                        }
                    })
                }


                
            }
            // window.onload = () => {
                // setTimeout(() => {start("test")}, Math.random() * 3)
            // }
        }
        
    </script>
    <select id="userPicker">
        <option value="0">user01</option>
        <option value="1">user02</option>
        <option value="2">user03</option>
        <option value="3">user04</option>
        <option value="4">user05</option>
    </select>

    <select id="rolePicker">
        <option value="1">teacher</option>
        <option value="2">student</option>
        <option value="3">assistant</option>
    </select>

    <input id="roomUuid" placeholder="roomUuid"></input>
    <button id="btn">test</button>
</body>
</html>
